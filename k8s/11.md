## Creating secret

```
kubectl create secret generic db-user-pass \
    --from-literal=username=admin \
    --from-literal=password=my-secret-password
```

`kubectl get secrets`
```
NAME                                     TYPE                 DATA   AGE
db-user-pass                             Opaque               2      22s
sh.helm.release.v1.app-kotlin-chart.v1   helm.sh/release.v1   1      6d
sh.helm.release.v1.app-python-chart.v1   helm.sh/release.v1   1      6d
```

`kubectl get secret db-user-pass -o jsonpath='{.data.password}' | base64 --decode`
```
my-secret-password
```


## Updating deployment to use secret
```
kubectl get po
NAME                                READY   STATUS    RESTARTS      AGE
app-python-d7b5d78df-9ckfz          1/1     Running   0             2m24s
```
My actual pod name is: `app-python-d7b5d78df-9ckfz`.
Let's check if it contains my secret:
```
kubectl exec app-python-d7b5d78df-9ckfz -- printenv | grep MY_PASSWORD
MY_PASSWORD=my-secret-password
```

## Using vault

I added secrets following by a guideline and here is what I have now:

`kubectl get pods`
```
NAME                                        READY   STATUS     RESTARTS      AGE
app-python-secrets-chart-55b89766fd-7hbxt   1/1     Running    0             26m
vault-0                                     1/1     Running    1 (31m ago)   25h
vault-agent-injector-5cd8b87c6c-bflh9       1/1     Running    1 (31m ago)   25h
```

Let's check the secret:
`$ cat vault/secrets/database-config.txt`
```
postgresql://db-readonly-user:db-secret-password@postgres:5432/wizard
```

and check the volumes:
`df -h`
```
Filesystem      Size  Used Avail Use% Mounted on
overlay          59G   14G   43G  25% /
tmpfs            64M     0   64M   0% /dev
tmpfs           7.5G  4.0K  7.5G   1% /vault/secrets
/dev/vda1        59G   14G   43G  25% /etc/hosts
shm              64M     0   64M   0% /dev/shm
tmpfs           7.7G   12K  7.7G   1% /run/secrets/kubernetes.io/serviceaccount
tmpfs           3.9G     0  3.9G   0% /sys/firmware
```